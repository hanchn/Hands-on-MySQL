大家好，我是三日老师。今天我们来讲一个非常贴近实际业务的场景——如何查询库存异动明细，尤其是在电商系统里，这个功能特别重要。

我们先来聊聊什么是库存异动。简单来说，就是库存数量的“每一次变化”，比如你：

创建了一笔采购入库，库存+50；

客户下了一笔订单发货，库存-20；

做了一次盘点修正，库存+2 或 -1；

这些操作看起来很小，但正是它们构成了整个库存的变化过程。我们不能只看当前库存是多少，更要能回溯每一步“怎么变的”，这就是库存流水。

那我们该怎么设计和查询这种库存异动呢？

通常我们会有一张“库存流水表”，记录每一次异动的：

商品 ID

操作时间

操作类型，比如入库、出库、盘点

异动数量，比如 +50、-20

当前操作后的库存余额

你可以理解这张表像是一份“银行流水账”，每一条都是一次操作的记录，顺着时间往下看，就能推算出库存是怎么一点点变成现在这个数的。

在实际查询中，我们经常会问：

最近一周某个商品有哪些异动？

最近一次出库是因为什么订单？

昨天所有商品的库存变动汇总是多少？

这时候你就会用到：

WHERE 来筛选商品、时间；

ORDER BY 来按时间排出变动顺序；

还可以用 SUM 来统计总的入库量或出库量；

甚至可以通过 LEFT JOIN 关联操作来源，比如订单表、采购单、盘点表，来看这次变动到底是哪来的。

总之，库存流水的查询，不是只看“现在剩多少”，而是要清楚“每一步是怎么来的”。这是很多系统排查问题的核心依据。

总结一下：
库存异动就是每一次数量变化的记录；
你需要建一张“库存流水表”；
然后用时间、类型、商品 ID 去查询；
还能结合统计、分组、排序，做出详细的库存变动日志。

今天我们先聊到这里，我们下期再见。

