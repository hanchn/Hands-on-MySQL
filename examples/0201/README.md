大家好，我是三日老师。今天我们来聊聊数据库建模中最核心的结构之一：“订单、用户、商品”三表关系该怎么设计。

这个结构几乎出现在每一个电商系统、SaaS 平台、订阅服务里，是最标准的“购买行为模型”。

我们先来看看三张表的基本含义：

用户表：记录的是用户的基础信息，比如姓名、手机号、注册时间等等；

商品表：记录所有可售商品的信息，比如名称、价格、库存状态等；

订单表：则是用户买了哪些商品、买了多少、花了多少钱的核心记录。

但这里有一个关键点很多人容易忽略：一笔订单可以包含多个商品，对不对？所以我们不能直接把“商品 ID”塞进订单表里，而是要引入一个中间表——我们叫它“订单明细表”。

这就形成了一个完整的四表结构：

用户和订单是一对多：一个用户可以下多个订单；

订单和商品是多对多：一张订单可以买多个商品，一个商品也可以出现在多张订单里；

所以需要一张中间表：订单明细表，用来描述“这张订单买了哪个商品、买了几件、单价是多少”。

这个结构一旦建好，你就可以：

查每个用户下过哪些订单；

查每个订单买了哪些商品；

查哪些商品销量最高；

甚至查某用户购买某商品的频率、最近一次购买时间。

还有一点很重要：订单数据属于交易行为，所以商品价格不要直接查商品表，因为价格随时会变。我们要把商品的“下单时价格”冗余记录在订单明细表里，确保历史订单不会因商品调价而改变金额。

总结一下：
订单、用户、商品构成了电商数据库的核心三表结构；
其中订单和商品之间是多对多关系，要用订单明细表来解耦；
订单明细表不仅要记录商品 ID，还要记录数量、价格等信息；
这样才能支撑后续的用户分析、订单追踪、营销推荐等功能。

今天我们先聊到这里，我们下期再见。

